<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Ken Burns Slideshow</title>
        <style>
            :root {
                --duration: 6000ms; /* length of each slide's pan+zoom */
                --fade: 1500ms; /* crossfade duration */
                --scale-start: 1.04; /* subtle zoom in */
                --scale-end: 1.14;
            }

            * {
                box-sizing: border-box;
            }

            body {
                margin: 0;
                background: #e6fff2;
                color: #fff;
                font-family:
                    system-ui,
                    -apple-system,
                    Segoe UI,
                    Roboto,
                    Helvetica,
                    Arial,
                    sans-serif;
            }

            .slideshow {
                border-radius: 50px;
                margin: 0 auto;
                margin-top: 5vh;
                position: relative;
                width: 60%;
                height: 90vh; /* 50% of viewport height */
                overflow: hidden;
                isolation: isolate; /* keep z-index layering clean */
            }

            .slideshow img {
                position: absolute;
                inset: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center center; /* vertical center alignment */
                opacity: 0;
                transition: opacity var(--fade) ease-in-out;
                will-change: transform, opacity;
                pointer-events: none;
                user-select: none;

                /* Defaults for CSS-var–driven Ken Burns */
                --tx-start: 0%;
                --ty-start: 0%;
                --tx-end: 0%;
                --ty-end: 0%;
                --kb-scale-start: var(--scale-start);
                --kb-scale-end: var(--scale-end);
                transform: translate(var(--tx-start), var(--ty-start))
                    scale(var(--kb-scale-start));
            }

            .slideshow img.active {
                opacity: 1;
                z-index: 2;
                animation: kenburns var(--duration) ease-in-out forwards;
            }

            .slideshow img.prev {
                opacity: 0;
                z-index: 1;
                /* transform is frozen inline by JS during fade-out */
            }

            @keyframes kenburns {
                from {
                    transform: translate(var(--tx-start), var(--ty-start))
                        scale(var(--kb-scale-start));
                }
                to {
                    transform: translate(var(--tx-end), var(--ty-end))
                        scale(var(--kb-scale-end));
                }
            }
        </style>
    </head>
    <body>
        <div class="slideshow" id="slideshow">
            <!-- Replace with your images -->
            <img
                src="https://www.brides.com/thmb/tOB8NuWNp_RklYDuWsKcODQEYCc=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Natalie_and_David-Fort_Worth_Wedding_2020_Mashaida_Photography-5Q8A8732.jpg-9c77005b2cd6423bb82304c3812413e5.jpg"
                alt="Slide 1"
                class="active"
            />
            <img
                src="https://www.brides.com/thmb/VcqJxs9Vr6B9Vp4DGqATiQocLGA=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/11-minimalist-french-inspired-texas-wedding-couple-portrait-the-lockharts-0424-9fa3bfbef45946248140c6fd5a834ee1.jpg"
                alt="Slide 2"
            />
            <img
                src="https://www.brides.com/thmb/KWd1O95kGeJYwPc9wsEVIZnKTbM=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Wedding-Pose-FOR-THE-LOVE-OF-IT-81f2ea6b25ce4902b553c425779388c5.jpg"
                alt="Slide 3"
            />
            <img
                src="https://www.brides.com/thmb/xtuXEB_u2M_k02JnEVAPUn2PTOQ=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Wedding-Poses-Wedding-Lena-Mirisola-2c54b74ec0c04c7a817ac7245af3d15d.JPG"
                alt="Slide 4"
            />
        </div>

        <script>
            (function () {
                const slides = Array.from(
                    document.querySelectorAll("#slideshow img"),
                );
                let current = 0;

                const DURATION = 6000; // must match --duration
                const FADE = 1500; // must match --fade

                // A few subtle pan directions (percentages keep movement gentle with object-fit: cover)
                const directions = [
                    // horizontal
                    { sx: "-4%", sy: "0%", ex: "4%", ey: "0%" }, // left -> right
                    { sx: "4%", sy: "0%", ex: "-4%", ey: "0%" }, // right -> left
                    // vertical
                    { sx: "0%", sy: "-4%", ex: "0%", ey: "4%" }, // top -> bottom
                    { sx: "0%", sy: "4%", ex: "0%", ey: "-4%" }, // bottom -> top
                    // diagonals
                    { sx: "-3%", sy: "-3%", ex: "3%", ey: "3%" }, // tl -> br
                    { sx: "3%", sy: "3%", ex: "-3%", ey: "-3%" }, // br -> tl
                    { sx: "-3%", sy: "3%", ex: "3%", ey: "-3%" }, // bl -> tr
                    { sx: "3%", sy: "-3%", ex: "-3%", ey: "3%" }, // tr -> bl
                ];

                function applyKenBurnsVars(img) {
                    const d =
                        directions[
                            Math.floor(Math.random() * directions.length)
                        ];
                    img.style.setProperty("--tx-start", d.sx);
                    img.style.setProperty("--ty-start", d.sy);
                    img.style.setProperty("--tx-end", d.ex);
                    img.style.setProperty("--ty-end", d.ey);

                    // Optional: small randomization of zoom to avoid sameness
                    const s1 = 1.03 + Math.random() * 0.03; // 1.03–1.06
                    const s2 = s1 + 0.08; // ~+0.08 zoom-in
                    img.style.setProperty("--kb-scale-start", s1.toFixed(3));
                    img.style.setProperty("--kb-scale-end", s2.toFixed(3));
                }

                // Initialize first slide
                applyKenBurnsVars(slides[0]);
                slides[0].classList.add("active");

                function showNext() {
                    const outgoing = slides[current];
                    const nextIndex = (current + 1) % slides.length;
                    const incoming = slides[nextIndex];

                    // --- Freeze outgoing transform to prevent the "jump" during fade ---
                    const computedTransform =
                        getComputedStyle(outgoing).transform;
                    if (computedTransform && computedTransform !== "none") {
                        outgoing.style.transform = computedTransform; // freeze at current
                    } else {
                        // if none, keep its current var-based transform
                        outgoing.style.transform =
                            getComputedStyle(outgoing).transform;
                    }
                    outgoing.style.animation = "none"; // stop ongoing keyframe animation
                    outgoing.classList.remove("active");
                    outgoing.classList.add("prev");

                    // Clean up 'prev' once fade completes
                    const onFadeEnd = (e) => {
                        if (e.propertyName === "opacity") {
                            outgoing.classList.remove("prev");
                            outgoing.style.transform = ""; // reset to defaults
                            outgoing.style.animation = ""; // allow future animations
                            outgoing.removeEventListener(
                                "transitionend",
                                onFadeEnd,
                            );
                        }
                    };
                    outgoing.addEventListener("transitionend", onFadeEnd);

                    // --- Prepare incoming slide with fresh Ken Burns vars ---
                    applyKenBurnsVars(incoming);
                    incoming.classList.add("active");
                    incoming.classList.remove("prev");

                    current = nextIndex;
                }

                // Cycle forever. We switch right at the end of each pan+zoom.
                setInterval(showNext, DURATION);
            })();
        </script>
    </body>
</html>
